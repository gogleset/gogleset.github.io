<!DOCTYPE html><html lang="ko" data-theme="cupcake"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="https://gogleset.github.io/_next/static/css/cc4162795b3fa97e.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="https://gogleset.github.io/_next/static/chunks/webpack-14f60f031ad37603.js"/><script src="https://gogleset.github.io/_next/static/chunks/fd9d1056-e158016523ed90e0.js" async=""></script><script src="https://gogleset.github.io/_next/static/chunks/23-45bdff8afeaaa1ce.js" async=""></script><script src="https://gogleset.github.io/_next/static/chunks/main-app-c91a41629f488782.js" async=""></script><script src="https://gogleset.github.io/_next/static/chunks/231-e841b6edcc38d627.js" async=""></script><script src="https://gogleset.github.io/_next/static/chunks/app/posts/%5Bid%5D/error-43f6426e3a7526c8.js" async=""></script><script src="https://gogleset.github.io/_next/static/chunks/app/layout-c5dcdd748a4b65d7.js" async=""></script><script src="https://gogleset.github.io/_next/static/chunks/app/global-error-9622828abc1b57c8.js" async=""></script><script src="https://gogleset.github.io/_next/static/chunks/173-085cf89c21a1457b.js" async=""></script><script src="https://gogleset.github.io/_next/static/chunks/app/posts/%5Bid%5D/page-ed3992e816e0c12e.js" async=""></script><link rel="preload" href="https://www.googletagmanager.com/gtag/js?id=undefined" as="script"/><title>Next.js Image 어떻게 최적화 할까?</title><meta name="description" content="Image 최적화 과정과 Canary 버전에서 확인해보는 신기능?도 있었다."/><meta name="keywords" content="gogleset,Next,Image"/><meta property="og:title" content="Next.js Image 어떻게 최적화 할까?"/><meta property="og:description" content="Image 최적화 과정과 Canary 버전에서 확인해보는 신기능?도 있었다."/><meta property="og:site_name" content="https://gogleset.github.io"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Next.js Image 어떻게 최적화 할까?"/><meta name="twitter:description" content="Image 최적화 과정과 Canary 버전에서 확인해보는 신기능?도 있었다."/><link rel="icon" href="/favicon-32x32.png"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><script src="https://gogleset.github.io/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body><header class=" border-gray-200 px-4 lg:px-6 py-3.5  max-h-[68px] w-full sticky top-0 bg-base-100"><div class="w-full max-w-[1140px] mx-auto"><div class="flex flex-wrap justify-between items-center "><div class="flex gap-3 items-center"><a class="self-center text-xl font-semibold whitespace-nowrap cursor-pointer" href="/">gogleset&#x27;s note</a><div class="divider divider-horizontal w-2 max-lg:hidden"></div><nav class="max-lg:hidden"><ul class="flex  gap-3 "><li class="self-center text-lg font-semibold whitespace-nowrap cursor-pointer"><a href="/about">About</a></li><li class="self-center text-lg font-semibold whitespace-nowrap cursor-pointer"><a href="/tags">Tags</a></li></ul></nav></div><div class="flex gap-4 items-center justify-center"><div class="flex max-lg:hidden"><label class="swap "><input type="checkbox"/><svg class="swap-off fill-current w-10 h-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"></path></svg><svg class="swap-on fill-current w-10 h-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"></path></svg></label></div><div class="drawer drawer-end lg:hidden"><input id="my-drawer-3" type="checkbox" class="drawer-toggle"/><div class="drawer-content flex flex-col"><div class=" w-full p-0"><div class="lg:hidden"><label for="my-drawer-3" aria-label="open sidebar" class="cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-8 h-8 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></label></div></div></div><div class="drawer-side"><label for="my-drawer-3" aria-label="close sidebar" class="drawer-overlay"></label><div class="menu p-4 w-80 min-h-full bg-base-200 justify-between"><ul class="flex flex-col gap-3 "><li class="self-center text-lg font-semibold whitespace-nowrap cursor-pointer"><a href="/about">About</a></li><li class="self-center text-lg font-semibold whitespace-nowrap cursor-pointer"><a href="/tags">Tags</a></li></ul><div class="flex justify-between"><svg class="fill-current cursor-pointer" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 512 512"><polygon points="400 145.49 366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49"></polygon></svg><label class="swap "><input type="checkbox"/><svg class="swap-off fill-current w-10 h-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"></path></svg><svg class="swap-on fill-current w-10 h-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z"></path></svg></label></div></div></div></div></div></div><progress class="progress progress-primary w-full backdrop-blur-[10px]" value="0" max="100"></progress></div></header><main class="flex w-full justify-center items-center flex-col"><article class="flex justify-center w-full max-w-[1080px] p-5"><!--$--><div class="flex flex-col w-full"><div class="flex flex-col items-center justify-center h-64 gap-3"><h1 class="text-3xl max-lg:text-2xl font-bold text-center">Next.js Image 어떻게 최적화 할까?</h1><div class="flex flex-col items-center justify-center gap-1"><span class="text-gray">2025-04-23</span><div class="flex gap-1 "><span class="badge badge-accent">Next</span><span class="badge badge-accent">Image</span></div></div></div><hr class="mb-[0px]"/><div class="flex flex-col prose max-w-full max-sm:prose-sm "><h1 id="toc">toc</h1>
<ul>
<li><a href="#nextjs-image-%EC%B5%9C%EC%A0%81%ED%99%94">Next.js Image 최적화</a>
<ul>
<li><a href="#%EC%99%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%EA%B0%80">왜 사용하는가?</a></li>
<li><a href="#%EC%9D%B4%EB%AF%B8%EC%A7%80-%ED%8F%AC%EB%A7%B7-%EB%B9%84%EA%B5%90-%ED%91%9C">이미지 포맷 비교 표</a></li>
<li><a href="#%EC%B0%B8%EA%B3%A0-mime-type-vs-content-type">참고) MIME Type vs Content-Type</a></li>
</ul>
</li>
<li><a href="#nextjs-image-%EC%9A%94%EC%B2%AD-%EC%B2%98%EB%A6%AC-%ED%9D%90%EB%A6%84">Next.js Image 요청 처리 흐름</a></li>
<li><a href="#%EC%A3%BC%EC%9A%94-%ED%8C%8C%EC%9D%BC">주요 파일</a></li>
<li><a href="#server">Server</a>
<ul>
<li><a href="#image-optimizerts">image-optimizer.ts</a>
<ul>
<li><a href="#%EC%A7%80%EC%9B%90%ED%95%98%EB%8A%94-%ED%98%95%EC%8B%9D%EC%9C%BC%EB%A1%9C%EC%9D%98-%ED%8F%AC%EB%A7%B7-%EB%B3%80%ED%99%98">지원하는 형식으로의 포맷 변환</a></li>
</ul>
</li>
<li><a href="#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%B5%9C%EC%A0%81%ED%99%94-%EC%A3%BC%EC%9A%94-%EC%B2%98%EB%A6%AC">이미지 최적화 주요 처리</a>
<ul>
<li><a href="#nextjs%EA%B0%80-%EA%B4%80%EB%A6%AC%ED%95%98%EB%8A%94-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%86%8D%EC%84%B1%EA%B0%92%EB%93%A4">Next.js가 관리하는 이미지 속성값들</a></li>
<li><a href="#%EC%A7%80%EC%9B%90%EB%90%98%EC%A7%80-%EC%95%8A%EB%8A%94-%EC%9D%B4%EB%AF%B8%EC%A7%80">지원되지 않는 이미지</a></li>
<li><a href="#contenttype-%EA%B2%B0%EC%A0%95">contentType 결정</a></li>
</ul>
</li>
<li><a href="#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%B5%9C%EC%A0%81%ED%99%94">이미지 최적화</a>
<ul>
<li><a href="#%EC%A3%BC%EC%9A%94-%EC%B2%98%EB%A6%AC">주요 처리:</a></li>
<li><a href="#%EC%8B%A4%ED%97%98%EC%A0%81-%EC%98%B5%EC%85%98sharp%EC%97%90%EC%84%9C-%EC%A7%80%EC%9B%90">실험적 옵션(sharp에서 지원)</a></li>
</ul>
</li>
<li><a href="#%EC%BA%90%EC%8B%B1-%EC%B2%98%EB%A6%AC">캐싱 처리</a>
<ul>
<li><a href="#%EC%BA%90%EC%8B%9C-%EC%A0%80%EC%9E%A5-%EB%B0%A9%EC%8B%9D">캐시 저장 방식</a></li>
</ul>
</li>
<li><a href="#next-serverts">next-server.ts</a>
<ul>
<li><a href="#handlenextimagerequest%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%9A%94%EC%B2%AD-%ED%95%B8%EB%93%A4%EB%9F%AC">handleNextImageRequest(이미지 요청 핸들러)</a></li>
<li><a href="#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%B5%9C%EC%A0%81%ED%99%94-%EC%BA%90%EC%8B%9C-%ED%81%B4%EB%9E%98%EC%8A%A4">이미지 최적화 캐시 클래스</a></li>
</ul>
</li>
<li><a href="#imageoptimizer">imageOptimizer</a></li>
</ul>
</li>
<li><a href="#client">Client</a>
<ul>
<li><a href="#image-externalts">image-external.ts</a>
<ul>
<li><a href="#defaultloader">defaultLoader</a></li>
</ul>
</li>
<li><a href="#getimgprops">getImgProps</a>
<ul>
<li><a href="#generateattrs">generateAttrs</a></li>
</ul>
</li>
<li><a href="#image">&lt;Image/&gt;</a>
<ul>
<li><a href="#image-%EC%BA%90%EC%8B%B1-%EC%A0%95%EC%B1%85">Image 캐싱 정책</a></li>
<li><a href="#vercel-%EB%B0%B0%ED%8F%AC-%EC%8B%9C-%EC%A3%BC%EC%9D%98%EC%A0%9020254%EC%9B%94-%EA%B8%B0%EC%A4%80">Vercel 배포 시 주의점(2025.4월 기준)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="nextjs-image-최적화">Next.js Image 최적화</h1>
<p>(2025.4 Canary 버전 기준)</p>
<hr/>
<h2 id="왜-사용하는가">왜 사용하는가?</h2>
<ul>
<li><strong>크기 최적화</strong>: 웹 친화적인 이미지 포맷으로 변환 (AVIF, WEBP 등)</li>
</ul>
<hr/>
<h2 id="이미지-포맷-비교-표">이미지 포맷 비교 표</h2>
<table><thead><tr><th>특성</th><th>AVIF</th><th>JPG/JPEG</th><th>PNG</th><th>WebP</th><th>MozJPEG</th></tr></thead><tbody><tr><td>개발자</td><td>Alliance for Open Media</td><td>Joint Photographic Experts Group</td><td>PNG Development Group</td><td>Google</td><td>Mozilla</td></tr><tr><td>압축 방식</td><td>손실/무손실</td><td>손실</td><td>무손실</td><td>손실/무손실</td><td>손실</td></tr><tr><td>파일 크기</td><td>매우 작음</td><td>중간</td><td>큼</td><td>작음</td><td>중간-작음</td></tr><tr><td>이미지 품질</td><td>매우 높음</td><td>중간-높음</td><td>매우 높음</td><td>높음</td><td>높음</td></tr><tr><td>투명도 지원</td><td>지원</td><td>미지원</td><td>지원</td><td>지원</td><td>미지원</td></tr><tr><td>애니메이션</td><td>지원</td><td>미지원</td><td>미지원(APNG 제외)</td><td>지원</td><td>미지원</td></tr><tr><td>브라우저 호환성</td><td>제한적</td><td>매우 높음</td><td>매우 높음</td><td>높음</td><td>매우 높음</td></tr><tr><td>적합한 용도</td><td>웹 이미지, 사진</td><td>사진, 웹 이미지</td><td>로고, 아이콘, 스크린샷</td><td>웹 이미지, 애니메이션</td><td>최적화된 웹 사진</td></tr><tr><td>색상 깊이</td><td>8-12비트</td><td>8비트</td><td>8-16비트</td><td>8비트</td><td>8비트</td></tr><tr><td>HDR 지원</td><td>지원</td><td>미지원</td><td>미지원</td><td>제한적</td><td>미지원</td></tr></tbody></table>
<ul>
<li>웹사이트 성능 최적화: AVIF나 WebP</li>
<li>호환성: JPG나 PNG</li>
</ul>
<hr/>
<h2 id="참고-mime-type-vs-contenttype">참고) MIME Type vs Content-Type</h2>
<table><thead><tr><th>항목</th><th>MIME 타입</th><th>Content-Type</th></tr></thead><tbody><tr><td>정의</td><td>파일 형식 식별을 위한 표준</td><td>HTTP 응답의 리소스 타입 명시</td></tr><tr><td>사용 범위</td><td>이메일, 웹, 프로그램 등 광범위</td><td>HTTP 통신에서 주로 사용</td></tr><tr><td>포함 정보</td><td>타입/서브타입 (예: <code>text/html</code>)</td><td>MIME 타입 + 선택 파라미터</td></tr><tr><td>예시</td><td><code>image/jpeg</code></td><td><code>Content-Type: image/jpeg; charset=UTF-8</code></td></tr><tr><td>독립성</td><td>다양한 프로토콜에서 사용</td><td>HTTP 헤더의 일부로 한정</td></tr></tbody></table>
<hr/>
<h1 id="nextjs-image-요청-처리-흐름">Next.js Image 요청 처리 흐름</h1>
<ol>
<li>브라우저가 <code>/_next/image/...</code> 경로로 요청</li>
<li><code>handleNextImageRequest</code>에서 요청 라우팅</li>
<li>파라미터 검증 및 캐시 확인</li>
<li>캐시가 있다면 반환</li>
<li>없다면 <code>imageOptimizer</code> 호출하여 최적화 수행 후 캐시에 저장</li>
</ol>
<hr/>
<h1 id="주요-파일">주요 파일</h1>
<ul>
<li>next-server.ts (server)</li>
<li>image-optimizer.ts (server)</li>
<li>image-external.ts (client)</li>
<li>image-component.ts(client)</li>
</ul>
<h1 id="server">Server</h1>
<h2 id="imageoptimizerts">image-optimizer.ts</h2>
<h3 id="지원하는-형식으로의-포맷-변환">지원하는 형식으로의 포맷 변환</h3>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">function</span> <span class="token function">getSupportedMimeType</span><span class="token punctuation">(</span>options<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> accept <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> mimeType <span class="token operator">=</span> <span class="token function">mediaType</span><span class="token punctuation">(</span>accept<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">return</span> accept<span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span>mimeType<span class="token punctuation">)</span> <span class="token operator">?</span> mimeType <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> mimeType <span class="token operator">=</span> <span class="token function">getSupportedMimeType</span><span class="token punctuation">(</span>formats <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span><span class="token property-access">headers</span><span class="token punctuation">[</span><span class="token string">&quot;accept&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>header에서 accept를 추출하여 브라우저에서 지원하는 값을 추출하고, 이 options 는</li>
</ul>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token comment">/** @type {import(&#x27;next&#x27;).NextConfig} */</span>
</span><span class="code-line"><span class="token keyword">const</span> nextConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  images<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    formats<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;image/avif&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;image/webp&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">default</span> nextConfig<span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>여기 작성한 formats 옵션이 들어간다. 기본값은 <a href="https://github.com/vercel/next.js/blob/canary/packages/next/src/server/image-optimizer.ts#L220">[image/webp]</a>이다. 지원하지 않으면 원본 포맷을 유지한다.</li>
</ul>
<h2 id="이미지-최적화-주요-처리">이미지 최적화 주요 처리</h2>
<h3 id="nextjs가-관리하는-이미지-속성값들">Next.js가 관리하는 이미지 속성값들</h3>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">const</span> <span class="token constant">AVIF</span> <span class="token operator">=</span> <span class="token string">&quot;image/avif&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">WEBP</span> <span class="token operator">=</span> <span class="token string">&quot;image/webp&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">PNG</span> <span class="token operator">=</span> <span class="token string">&quot;image/png&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">JPEG</span> <span class="token operator">=</span> <span class="token string">&quot;image/jpeg&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">GIF</span> <span class="token operator">=</span> <span class="token string">&quot;image/gif&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">SVG</span> <span class="token operator">=</span> <span class="token string">&quot;image/svg+xml&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">ICO</span> <span class="token operator">=</span> <span class="token string">&quot;image/x-icon&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">ICNS</span> <span class="token operator">=</span> <span class="token string">&quot;image/x-icns&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">TIFF</span> <span class="token operator">=</span> <span class="token string">&quot;image/tiff&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">BMP</span> <span class="token operator">=</span> <span class="token string">&quot;image/bmp&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">ANIMATABLE_TYPES</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">WEBP</span><span class="token punctuation">,</span> <span class="token constant">PNG</span><span class="token punctuation">,</span> <span class="token constant">GIF</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 움직일만한 타입(PNG는 APNG라는 포맷이 있다.)</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">BYPASS_TYPES</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">SVG</span><span class="token punctuation">,</span> <span class="token constant">ICO</span><span class="token punctuation">,</span> <span class="token constant">ICNS</span><span class="token punctuation">,</span> <span class="token constant">BMP</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 최적화 안해주는 타입들</span>
</span></code></pre>
<h3 id="지원되지-않는-이미지">지원되지 않는 이미지</h3>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">if</span> <span class="token punctuation">(</span>upstreamType<span class="token punctuation">.</span><span class="token method function property-access">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;image/svg&quot;</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>nextConfig<span class="token punctuation">.</span><span class="token property-access">images</span><span class="token punctuation">.</span><span class="token property-access">dangerouslyAllowSVG</span><span class="token punctuation">)</span>
</span></code></pre>
<ul>
<li>SVG는 <code>dangerouslyAllowSVG</code> 설정이 꺼져 있으면 에러 반환</li>
</ul>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">ANIMATABLE_TYPES</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span>upstreamType<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isAnimated</span><span class="token punctuation">(</span>upstreamBuffer<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre>
<ul>
<li>애니메이션 이미지(WEBP, PNG(APNG), GIF)는 최적화하지 않고 원본 반환</li>
</ul>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">BYPASS_TYPES</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span>upstreamType<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre>
<ul>
<li>최적화 대상에서 제외 (SVG, ICO, ICNS, BMP 등)</li>
</ul>
<h3 id="contenttype-결정">contentType 결정</h3>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">let</span> contentType <span class="token operator">=</span> mimeType <span class="token operator">??</span> upstreamType <span class="token operator">??</span> <span class="token constant">JPEG</span><span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>MIME 타입 &gt; upstreamType &gt; 기본값 JPEG 순서로 지정</li>
</ul>
<hr/>
<h2 id="이미지-최적화">이미지 최적화</h2>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">let</span> optimizedBuffer <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">optimizeImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">  buffer<span class="token operator">:</span> upstreamBuffer<span class="token punctuation">,</span>
</span><span class="code-line">  contentType<span class="token punctuation">,</span>
</span><span class="code-line">  quality<span class="token punctuation">,</span>
</span><span class="code-line">  width<span class="token punctuation">,</span>
</span><span class="code-line">  concurrency<span class="token operator">:</span> nextConfig<span class="token punctuation">.</span><span class="token property-access">experimental</span><span class="token punctuation">.</span><span class="token property-access">imgOptConcurrency</span><span class="token punctuation">,</span>
</span><span class="code-line">  limitInputPixels<span class="token operator">:</span> nextConfig<span class="token punctuation">.</span><span class="token property-access">experimental</span><span class="token punctuation">.</span><span class="token property-access">imgOptMaxInputPixels</span><span class="token punctuation">,</span>
</span><span class="code-line">  sequentialRead<span class="token operator">:</span> nextConfig<span class="token punctuation">.</span><span class="token property-access">experimental</span><span class="token punctuation">.</span><span class="token property-access">imgOptSequentialRead</span><span class="token punctuation">,</span>
</span><span class="code-line">  timeoutInSeconds<span class="token operator">:</span> nextConfig<span class="token punctuation">.</span><span class="token property-access">experimental</span><span class="token punctuation">.</span><span class="token property-access">imgOptTimeoutInSeconds</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">return</span> <span class="token punctuation">{</span>
</span><span class="code-line">  buffer<span class="token operator">:</span> optimizedBuffer<span class="token punctuation">,</span>
</span><span class="code-line">  contentType<span class="token punctuation">,</span>
</span><span class="code-line">  maxAge<span class="token punctuation">,</span>
</span><span class="code-line">  etag<span class="token operator">:</span> <span class="token function">getImageEtag</span><span class="token punctuation">(</span>optimizedBuffer<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">  upstreamEtag<span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>optimizedBuffer를 받게된다.</li>
</ul>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">optimizeImage</span><span class="token punctuation">(</span><span class="token spread operator">...</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token spread operator">...</span> <span class="token punctuation">}</span>
</span></code></pre>
<h3 id="주요-처리">주요 처리:</h3>
<ul>
<li><code>sharp</code> 라이브러리 사용(squoosh는 제외됨)</li>
<li>사이즈 조절: <code>resize(width, height)</code></li>
<li>포맷별 설정:<!-- -->
<ul>
<li>AVIF: <code>quality - 20</code>, <code>effort: 3</code></li>
<li>WEBP, PNG, JPEG: 각 포맷에 맞는 옵션 적용</li>
</ul>
</li>
<li>최종 버퍼 반환</li>
</ul>
<h3 id="실험적-옵션sharp에서-지원">실험적 옵션(sharp에서 지원)</h3>
<table><thead><tr><th>옵션명</th><th>설명</th></tr></thead><tbody><tr><td><code>concurrency</code></td><td>동시 최적화 제한</td></tr><tr><td><code>limitInputPixels</code></td><td>입력 이미지 픽셀 제한</td></tr><tr><td><code>sequentialRead</code></td><td>순차 읽기 활성화 여부</td></tr><tr><td><code>timeoutInSeconds</code></td><td>최적화 타임아웃 설정</td></tr></tbody></table>
<hr/>
<h2 id="캐싱-처리">캐싱 처리</h2>
<h3 id="캐시-저장-방식">캐시 저장 방식</h3>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">writeToCacheDir</span><span class="token punctuation">(</span>
</span><span class="code-line"><span class="token spread operator">...</span>
</span><span class="code-line"><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> filename <span class="token operator">=</span> <span class="token function">join</span><span class="token punctuation">(</span>
</span><span class="code-line">    dir<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>maxAge<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expireAt<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>etag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>upstreamEtag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>extension<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
</span><span class="code-line">  <span class="token punctuation">)</span>
</span><span class="code-line"><span class="token spread operator">...</span> <span class="token keyword">await</span> promises<span class="token punctuation">.</span><span class="token method function property-access">writeFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> buffer<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span></code></pre>
<ul>
<li>이미지 캐시 파일명은 정보 기반으로 구성</li>
</ul>
<h2 id="nextserverts">next-server.ts</h2>
<h3 id="handlenextimagerequest이미지-요청-핸들러">handleNextImageRequest(이미지 요청 핸들러)</h3>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line">	 <span class="token comment">// URL 경로가 없거나 &#x27;/_next/image&#x27;로 시작하지 않으면 처리하지 않음</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>parsedUrl<span class="token punctuation">.</span><span class="token property-access">pathname</span> <span class="token operator">||</span> <span class="token operator">!</span>parsedUrl<span class="token punctuation">.</span><span class="token property-access">pathname</span><span class="token punctuation">.</span><span class="token method function property-access">startsWith</span><span class="token punctuation">(</span><span class="token string">&#x27;/_next/image&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">return</span> <span class="token boolean">false</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token comment">// 미들웨어 요청이면 처리하지 않음</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getRequestMeta</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token string">&#x27;middlewareInvoke&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">return</span> <span class="token boolean">false</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">     <span class="token comment">// 최소 모드이거나 정적 내보내기 모드일 경우 이미지 최적화를 처리하지 않고 400 오류 반환</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>
</span><span class="code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">minimalMode</span> <span class="token operator">||</span>
</span><span class="code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">nextConfig</span><span class="token punctuation">.</span><span class="token property-access">output</span> <span class="token operator">===</span> <span class="token string">&#x27;export&#x27;</span> <span class="token operator">||</span>
</span><span class="code-line">      process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">NEXT_MINIMAL</span>
</span><span class="code-line">    <span class="token punctuation">)</span>
</span></code></pre>
<h3 id="이미지-최적화-캐시-클래스">이미지 최적화 캐시 클래스</h3>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">const</span> imageOptimizerCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageOptimizerCache</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">  distDir<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">distDir</span><span class="token punctuation">,</span>
</span><span class="code-line">  nextConfig<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">nextConfig</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>최적화된 이미지가 저장되는 디렉토리를 관리하는 클래스</li>
<li>이미지 최적화 캐시 인스턴스 생성</li>
</ul>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">const</span> paramsResult <span class="token operator">=</span> <span class="token maybe-class-name">ImageOptimizerCache</span><span class="token punctuation">.</span><span class="token method function property-access">validateParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> cacheKey <span class="token operator">=</span> <span class="token maybe-class-name">ImageOptimizerCache</span><span class="token punctuation">.</span><span class="token method function property-access">getCacheKey</span><span class="token punctuation">(</span>paramsResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>이미지 최적화 캐시 클래스에서 이미지 검증과 캐시 키를 가져옴</li>
</ul>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line">   <span class="token keyword">const</span> cacheEntry <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">imageResponseCache</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>
</span><span class="code-line">          cacheKey<span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> previousCacheEntry <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token keyword">const</span> <span class="token punctuation">{</span> buffer<span class="token punctuation">,</span> contentType<span class="token punctuation">,</span> maxAge<span class="token punctuation">,</span> upstreamEtag<span class="token punctuation">,</span> etag <span class="token punctuation">}</span> <span class="token operator">=</span>
</span><span class="code-line">              <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">imageOptimizer</span><span class="token punctuation">(</span>
</span><span class="code-line">              <span class="token spread operator">...</span>
</span><span class="code-line">              <span class="token punctuation">)</span>
</span><span class="code-line">         <span class="token spread operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token punctuation">{</span>
</span><span class="code-line">            routeKind<span class="token operator">:</span> <span class="token maybe-class-name">RouteKind</span><span class="token punctuation">.</span><span class="token constant">IMAGE</span><span class="token punctuation">,</span>
</span><span class="code-line">            incrementalCache<span class="token operator">:</span> imageOptimizerCache<span class="token punctuation">,</span>
</span><span class="code-line">            isFallback<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token punctuation">}</span>
</span><span class="code-line">        <span class="token punctuation">)</span>
</span></code></pre>
<hr/>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token function">responseGenerator</span><span class="token punctuation">(</span><span class="token punctuation">{</span> hasResolved<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> previousCacheEntry<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<ul>
<li>이런식으로 imageOtimizer를 this.imageResponseCache.get에서 활용하고 있다.</li>
</ul>
<h2 id="imageoptimizer">imageOptimizer</h2>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">protected</span> <span class="token keyword">async</span> <span class="token function">imageOptimizer</span><span class="token punctuation">(</span><span class="token spread operator">...</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">				<span class="token spread operator">...</span>
</span><span class="code-line">				<span class="token comment">// 절대 루트인지 확인해서 외부 이미지, 내부이미지 구분</span>
</span><span class="code-line">			<span class="token keyword">const</span> imageUpstream <span class="token operator">=</span> isAbsolute
</span><span class="code-line">        <span class="token operator">?</span> <span class="token keyword">await</span> <span class="token function">fetchExternalImage</span><span class="token punctuation">(</span>href<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token operator">:</span> <span class="token keyword">await</span> <span class="token function">fetchInternalImage</span><span class="token punctuation">(</span>
</span><span class="code-line">            href<span class="token punctuation">,</span>
</span><span class="code-line">            req<span class="token punctuation">.</span><span class="token property-access">originalRequest</span><span class="token punctuation">,</span>
</span><span class="code-line">            res<span class="token punctuation">.</span><span class="token property-access">originalResponse</span><span class="token punctuation">,</span>
</span><span class="code-line">            handleInternalReq
</span><span class="code-line">          <span class="token punctuation">)</span>
</span><span class="code-line">				<span class="token comment">//image-optimizer.ts에 있는 함수</span>
</span><span class="code-line">      <span class="token keyword">return</span> <span class="token function">imageOptimizer</span><span class="token punctuation">(</span>imageUpstream<span class="token punctuation">,</span> paramsResult<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">nextConfig</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">        isDev<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">renderOpts</span><span class="token punctuation">.</span><span class="token property-access">dev</span><span class="token punctuation">,</span>
</span><span class="code-line">        previousCacheEntry<span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</span></code></pre>
<ul>
<li>외부 URL → <code>fetchExternalImage(href)</code></li>
<li>내부 URL → <code>fetchInternalImage(...)</code></li>
<li>이후 최적화 수행 및 캐시 저장</li>
</ul>
<h1 id="client">Client</h1>
<h2 id="imageexternalts">image-external.ts</h2>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getImageProps</span><span class="token punctuation">(</span>imgProps<span class="token operator">:</span> <span class="token maybe-class-name">ImageProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token spread operator">...</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token maybe-class-name">Image</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">ImageProps</span><span class="token punctuation">,</span> <span class="token maybe-class-name">ImageLoaderProps</span><span class="token punctuation">,</span> <span class="token maybe-class-name">ImageLoader</span><span class="token punctuation">,</span> <span class="token maybe-class-name">StaticImageData</span> <span class="token punctuation">}</span>
</span></code></pre>
<ul>
<li>기본적으로 Image 컴포넌트를 내보내고, 타입과 getImageProps 함수를 내보낸다.</li>
</ul>
<h3 id="defaultloader">defaultLoader</h3>
<ul>
<li>next image의 src path 리턴</li>
</ul>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">ImageLoaderPropsWithConfig</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./image-config&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">DEFAULT_Q</span> <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function">defaultLoader</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">  config<span class="token punctuation">,</span>
</span><span class="code-line">  src<span class="token punctuation">,</span>
</span><span class="code-line">  width<span class="token punctuation">,</span>
</span><span class="code-line">  quality<span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token operator">:</span> <span class="token maybe-class-name">ImageLoaderPropsWithConfig</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// 이미지 유효성 확인 로직</span>
</span><span class="code-line">  <span class="token keyword">const</span> q <span class="token operator">=</span>
</span><span class="code-line">    quality <span class="token operator">||</span>
</span><span class="code-line">    <span class="token comment">// image 퀄리티를 제한하려면 next.config에 구성을 추가할 수 있습니다.</span>
</span><span class="code-line">    config<span class="token punctuation">.</span><span class="token property-access">qualities</span><span class="token operator">?.</span><span class="token method function property-access">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>prev<span class="token punctuation">,</span> cur<span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span>
</span><span class="code-line">      <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">abs</span><span class="token punctuation">(</span>cur <span class="token operator">-</span> <span class="token constant">DEFAULT_Q</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">abs</span><span class="token punctuation">(</span>prev <span class="token operator">-</span> <span class="token constant">DEFAULT_Q</span><span class="token punctuation">)</span> <span class="token operator">?</span> cur <span class="token operator">:</span> prev
</span><span class="code-line">    <span class="token punctuation">)</span> <span class="token operator">||</span>
</span><span class="code-line">    <span class="token constant">DEFAULT_Q</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?url=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;w=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>width<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;q=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>q<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
</span></span></span><span class="code-line"><span class="token template-string"><span class="token interpolation">    src<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;/_next/static/media/&quot;</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NEXT_DEPLOYMENT_ID</span>
</span></span></span><span class="code-line"><span class="token template-string"><span class="token interpolation">      <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&amp;dpl=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NEXT_DEPLOYMENT_ID</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
</span></span></span><span class="code-line"><span class="token template-string"><span class="token interpolation">      <span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
</span></span></span><span class="code-line"><span class="token template-string"><span class="token interpolation">  <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// We use this to determine if the import is the default loader</span>
</span><span class="code-line"><span class="token comment">// or a custom loader defined by the user in next.config.js</span>
</span><span class="code-line">defaultLoader<span class="token punctuation">.</span><span class="token property-access">__next_img_default</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">default</span> defaultLoader<span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>사용자가 직접 <code>quality</code>를 지정했다면 그걸 쓰고, 지정 안 했다면 <code>config.qualities</code> 목록에서 75와 가장 가까운 걸 골라서 쓰고, 그것도 없으면 기본값인 <code>75</code>를 사용한다.</li>
</ul>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">const</span> <span class="token constant">DEFAULT_Q</span> <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> qualities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> closestQuality <span class="token operator">=</span> qualities<span class="token punctuation">.</span><span class="token method function property-access">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>prev<span class="token punctuation">,</span> cur<span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> prevDiff <span class="token operator">=</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">abs</span><span class="token punctuation">(</span>prev <span class="token operator">-</span> <span class="token constant">DEFAULT_Q</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> curDiff <span class="token operator">=</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">abs</span><span class="token punctuation">(</span>cur <span class="token operator">-</span> <span class="token constant">DEFAULT_Q</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">abs</span><span class="token punctuation">(</span>cur <span class="token operator">-</span> <span class="token constant">DEFAULT_Q</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">abs</span><span class="token punctuation">(</span>prev <span class="token operator">-</span> <span class="token constant">DEFAULT_Q</span><span class="token punctuation">)</span> <span class="token operator">?</span> cur <span class="token operator">:</span> prev<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>closestQuality<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>확인해보기</li>
</ul>
<h2 id="getimgprops">getImgProps</h2>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getImgProps</span><span class="token punctuation">(</span>
</span><span class="code-line"><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token spread operator">...</span><span class="token maybe-class-name">ImageProps</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> _state<span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span>
</span><span class="code-line">    props<span class="token operator">:</span> 실제 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> 태그에 들어갈 최종 속성들,
</span></span><span class="code-line"><span class="token plain-text">    meta: </span><span class="token punctuation">{</span>
</span><span class="code-line">      unoptimized<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token comment">// 최적화 비활성화 여부</span>
</span><span class="code-line">      priority<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token comment">// 우선 로딩 여부</span>
</span><span class="code-line">      placeholder<span class="token operator">:</span> <span class="token string">&#x27;blur&#x27;</span> <span class="token operator">|</span> <span class="token string">&#x27;empty&#x27;</span> <span class="token comment">// 플레이스홀더 타입</span>
</span><span class="code-line">      fill<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token comment">// 부모 요소에 맞게 꽉 채울지 여부</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">  }
</span></span><span class="code-line"><span class="token plain-text">}
</span></span></code></pre>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token comment">// 예외 처리 및 이미지 스타일, 백그라운드 이미지, 사이즈 속성이 설정된 후</span>
</span><span class="code-line"><span class="token keyword">const</span> imgAttributes <span class="token operator">=</span> <span class="token function">generateImgAttrs</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">  config<span class="token punctuation">,</span>
</span><span class="code-line">  src<span class="token punctuation">,</span>
</span><span class="code-line">  unoptimized<span class="token punctuation">,</span>
</span><span class="code-line">  width<span class="token operator">:</span> widthInt<span class="token punctuation">,</span>
</span><span class="code-line">  quality<span class="token operator">:</span> qualityInt<span class="token punctuation">,</span>
</span><span class="code-line">  sizes<span class="token punctuation">,</span>
</span><span class="code-line">  loader<span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>Image의 src, sizes, srcSet을 결정하는 generateImgAttrs를 통과한다.</li>
</ul>
<h3 id="generateattrs">generateAttrs</h3>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">function</span> <span class="token function">generateImgAttrs</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">  config<span class="token punctuation">,</span>
</span><span class="code-line">  src<span class="token punctuation">,</span>
</span><span class="code-line">  unoptimized<span class="token punctuation">,</span>
</span><span class="code-line">  width<span class="token punctuation">,</span>
</span><span class="code-line">  quality<span class="token punctuation">,</span>
</span><span class="code-line">  sizes<span class="token punctuation">,</span>
</span><span class="code-line">  loader<span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token operator">:</span> <span class="token maybe-class-name">GenImgAttrsData</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">GenImgAttrsResult</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>unoptimized<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token punctuation">{</span> src<span class="token punctuation">,</span> srcSet<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> sizes<span class="token operator">:</span> <span class="token keyword">undefined</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token comment">// size가 있는 경우 sizes 또는 width 값을 기준으로 적절한 width 목록을 계산</span>
</span><span class="code-line">  <span class="token comment">// width가 있는 경우, kind:x (배율계산)</span>
</span><span class="code-line">  <span class="token comment">// size, width가 없다면 deviceSize를 씀</span>
</span><span class="code-line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> widths<span class="token punctuation">,</span> kind <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getWidths</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span> width<span class="token punctuation">,</span> sizes<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> last <span class="token operator">=</span> widths<span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token comment">// kind는 w(width), x(배율)</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span>
</span><span class="code-line">    sizes<span class="token operator">:</span> <span class="token operator">!</span>sizes <span class="token operator">&amp;&amp;</span> kind <span class="token operator">===</span> <span class="token string">&quot;w&quot;</span> <span class="token operator">?</span> <span class="token string">&quot;100vw&quot;</span> <span class="token operator">:</span> sizes<span class="token punctuation">,</span>
</span><span class="code-line">    srcSet<span class="token operator">:</span> widths
</span><span class="code-line">      <span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span>
</span><span class="code-line">        <span class="token punctuation">(</span>w<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span>
</span><span class="code-line">          <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token punctuation">{</span> config<span class="token punctuation">,</span> src<span class="token punctuation">,</span> quality<span class="token punctuation">,</span> width<span class="token operator">:</span> w <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
</span></span></span><span class="code-line"><span class="token template-string"><span class="token interpolation">            kind <span class="token operator">===</span> <span class="token string">&quot;w&quot;</span> <span class="token operator">?</span> w <span class="token operator">:</span> i <span class="token operator">+</span> <span class="token number">1</span>
</span></span></span><span class="code-line"><span class="token template-string"><span class="token interpolation">          <span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>kind<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
</span><span class="code-line">      <span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span><span class="token string">&quot;, &quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    src<span class="token operator">:</span> <span class="token function">loader</span><span class="token punctuation">(</span><span class="token punctuation">{</span> config<span class="token punctuation">,</span> src<span class="token punctuation">,</span> quality<span class="token punctuation">,</span> width<span class="token operator">:</span> widths<span class="token punctuation">[</span>last<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<p><strong>return</strong></p>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">const</span> props<span class="token operator">:</span> <span class="token maybe-class-name">ImgProps</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token spread operator">...</span>rest<span class="token punctuation">,</span>
</span><span class="code-line">  loading<span class="token operator">:</span> isLazy <span class="token operator">?</span> <span class="token string">&quot;lazy&quot;</span> <span class="token operator">:</span> loading<span class="token punctuation">,</span>
</span><span class="code-line">  fetchPriority<span class="token punctuation">,</span>
</span><span class="code-line">  width<span class="token operator">:</span> widthInt<span class="token punctuation">,</span>
</span><span class="code-line">  height<span class="token operator">:</span> heightInt<span class="token punctuation">,</span>
</span><span class="code-line">  decoding<span class="token punctuation">,</span>
</span><span class="code-line">  className<span class="token punctuation">,</span>
</span><span class="code-line">  style<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token spread operator">...</span>imgStyle<span class="token punctuation">,</span> <span class="token spread operator">...</span>placeholderStyle <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  sizes<span class="token operator">:</span> imgAttributes<span class="token punctuation">.</span><span class="token property-access">sizes</span><span class="token punctuation">,</span>
</span><span class="code-line">  srcSet<span class="token operator">:</span> imgAttributes<span class="token punctuation">.</span><span class="token property-access">srcSet</span><span class="token punctuation">,</span>
</span><span class="code-line">  src<span class="token operator">:</span> overrideSrc <span class="token operator">||</span> imgAttributes<span class="token punctuation">.</span><span class="token property-access">src</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> meta <span class="token operator">=</span> <span class="token punctuation">{</span> unoptimized<span class="token punctuation">,</span> priority<span class="token punctuation">,</span> placeholder<span class="token punctuation">,</span> fill <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">return</span> <span class="token punctuation">{</span> props<span class="token punctuation">,</span> meta <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>이로써 최종 Image 컴포넌트로의 속성들이 결정된다.</li>
</ul>
<h2 id="image">&lt;Image/&gt;</h2>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token maybe-class-name">Image</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">forwardRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLImageElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span> ImageProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
</span><span class="code-line">  <span class="token punctuation">(</span>props<span class="token punctuation">,</span> forwardedRef<span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">const</span> isAppRouter <span class="token operator">=</span> <span class="token operator">!</span>pagesRouter
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">const</span> configContext <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span><span class="token maybe-class-name">ImageConfigContext</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token comment">// config를 가져옴</span>
</span><span class="code-line">    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">const</span> c <span class="token operator">=</span> configEnv <span class="token operator">||</span> configContext <span class="token operator">||</span> imageConfigDefault
</span><span class="code-line">      <span class="token keyword">const</span> allSizes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token spread operator">...</span>c<span class="token punctuation">.</span><span class="token property-access">deviceSizes</span><span class="token punctuation">,</span> <span class="token spread operator">...</span>c<span class="token punctuation">.</span><span class="token property-access">imageSizes</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> a <span class="token operator">-</span> b<span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token keyword">const</span> deviceSizes <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token property-access">deviceSizes</span><span class="token punctuation">.</span><span class="token method function property-access">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> a <span class="token operator">-</span> b<span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token keyword">const</span> qualities <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token property-access">qualities</span><span class="token operator">?.</span><span class="token method function property-access">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> a <span class="token operator">-</span> b<span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token spread operator">...</span>c<span class="token punctuation">,</span> allSizes<span class="token punctuation">,</span> deviceSizes<span class="token punctuation">,</span> qualities <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>configContext<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token spread operator">...</span>
</span><span class="code-line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> props<span class="token operator">:</span> imgAttributes<span class="token punctuation">,</span> meta<span class="token operator">:</span> imgMeta <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getImgProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">      defaultLoader<span class="token punctuation">,</span>
</span><span class="code-line">      imgConf<span class="token operator">:</span> config<span class="token punctuation">,</span>
</span><span class="code-line">      blurComplete<span class="token punctuation">,</span>
</span><span class="code-line">      showAltText<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">   <span class="token keyword">return</span> <span class="token spread operator">...</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">
</span></code></pre>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line"><span class="token keyword">return</span> <span class="token punctuation">(</span>
</span><span class="code-line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">    </span><span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ImageElement</span></span>
</span></span><span class="code-line"><span class="token tag">        <span class="token spread"><span class="token punctuation">{</span><span class="token spread operator">...</span>imgAttributes<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">        <span class="token attr-name">unoptimized</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>imgMeta<span class="token punctuation">.</span><span class="token property-access">unoptimized</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">        <span class="token attr-name">placeholder</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>imgMeta<span class="token punctuation">.</span><span class="token property-access">placeholder</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">        <span class="token attr-name">fill</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>imgMeta<span class="token punctuation">.</span><span class="token property-access">fill</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">        <span class="token attr-name">onLoadRef</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onLoadRef<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">        <span class="token attr-name">onLoadingCompleteRef</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onLoadingCompleteRef<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">        <span class="token attr-name">setBlurComplete</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>setBlurComplete<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">        <span class="token attr-name">setShowAltText</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>setShowAltText<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">        <span class="token attr-name">sizesInput</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span><span class="token property-access">sizes</span><span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">        <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>forwardedRef<span class="token punctuation">}</span></span>
</span></span><span class="code-line"><span class="token tag">      <span class="token punctuation">/&gt;</span></span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">    // 미리 로드
</span></span><span class="code-line"><span class="token plain-text">    </span><span class="token punctuation">{</span>imgMeta<span class="token punctuation">.</span><span class="token property-access">priority</span> <span class="token operator">?</span> <span class="token punctuation">(</span>
</span><span class="code-line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ImagePreload</span></span> <span class="token attr-name">isAppRouter</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>isAppRouter<span class="token punctuation">}</span></span> <span class="token attr-name">imgAttributes</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>imgAttributes<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
</span><span class="code-line">    <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line"><span class="token plain-text">  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
</span><span class="code-line"><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<ul>
<li>imgMeta.priority 속성을 활용해 Preload 판단을 하고, preload를 한다<!-- -->
<ul>
<li>App router라면 ReactDom.Preload를 활용해 preload를 한다</li>
<li>아니라면, Head 컴포넌트를 사용하여 preload</li>
</ul>
</li>
</ul>
<p>번외</p>
<h3 id="image-캐싱-정책">Image 캐싱 정책</h3>
<ul>
<li><strong>이미지 캐싱 위치</strong>
<ul>
<li>이미지는 요청 시 실시간으로 최적화되며, 결과는 <code>/.next/cache/images</code> 폴더에 저장된다.</li>
<li>저장된 이미지는 만료될 때까지 반복해서 사용된다.</li>
</ul>
</li>
<li><strong>만료되었을 때</strong>
<ul>
<li>만료된 이미지 요청 시, <strong>바로 이전 이미지(STALE)를 먼저 응답</strong>하고, <strong>백그라운드에서 새로 최적화</strong>해서 캐시에 다시 저장한다 → <code>revalidation</code></li>
</ul>
</li>
<li><strong>응답 헤더로 캐시 상태 확인 가능</strong>
<ul>
<li><code>x-nextjs-cache</code> 헤더 값으로 확인 가능:<!-- -->
<ul>
<li><code>MISS</code>: 캐시에 없음 (첫 요청 시)</li>
<li><code>STALE</code>: 만료된 이미지지만 즉시 응답하고 백그라운드 재검증 중</li>
<li><code>HIT</code>: 유효한 캐시 이미지로 응답</li>
</ul>
</li>
</ul>
</li>
<li><strong>캐시 만료 기준</strong>
<ul>
<li><code>minimumCacheTTL</code>과 원본 이미지의 <code>Cache-Control</code> 헤더의 <code>max-age</code> 중 <strong>더 큰 값</strong>이 사용된다.</li>
<li><code>s-maxage</code>가(CDN, proxy) 있으면 <code>max-age</code>보다 우선된다.</li>
<li>이 값은 CDN, 브라우저 등 downstream 클라이언트에게도 전달된다.</li>
</ul>
</li>
<li><strong>minimumCacheTTL 설정</strong>
<ul>
<li>기본값: <code>60초</code></li>
<li>설정 예:<!-- -->
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line">module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  images<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    minimumCacheTTL<span class="token operator">:</span> <span class="token number">2678400</span><span class="token punctuation">,</span> <span class="token comment">// 31일</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre>
</li>
<li>TTL(Time To Live - 캐시의 수명)이 낮으면 캐시 재검증이 자주 일어나지만 변경 사항 반영이 빠르다.</li>
<li>TTL이 높으면 비용 절감에는 유리하지만 캐시 무효화가 어렵다.</li>
</ul>
</li>
<li><strong>주의 사항</strong>
<ul>
<li>개별 이미지의 캐시를 무효화하려면 <code>src</code>를 변경하거나 <code>.next/cache/images</code> 폴더를 직접 삭제</li>
<li><code>/_next/image</code>가 아닌 실제 원본 이미지(<code>/some-asset.jpg</code>)의 <code>Cache-Control</code> 헤더를 설정하여 캐시 전략을 개별적으로 제어할 수 있음.</li>
</ul>
</li>
</ul>
<h3 id="vercel-배포-시-주의점20254월-기준">Vercel 배포 시 주의점(2025.4월 기준)</h3>
<table><thead><tr><th>항목</th><th>hobby 포함</th><th>pro 포함</th><th>Pro/Enterprise 추가 요금</th></tr></thead><tbody><tr><td>이미지 변환</td><td>5천 달러/월</td><td>1만 달러/월</td><td>1K당 $0.05 - $0.0812</td></tr><tr><td>이미지 캐시 읽기</td><td>30만/월</td><td>60만/월</td><td>1M당 $0.40 - $0.64</td></tr><tr><td>이미지 캐시 쓰기</td><td>10만/월</td><td>20만/월</td><td>1M당 $4.00 - $6.40</td></tr></tbody></table>
<ul>
<li><a href="https://vercel.com/docs/image-optimization/limits-and-pricing#image-transformations"><strong>이미지 변환</strong></a> , <a href="https://vercel.com/docs/image-optimization/limits-and-pricing#image-cache-reads"><strong>이미지 캐시 읽기</strong></a> , <a href="https://vercel.com/docs/image-optimization/limits-and-pricing#image-cache-writes"><strong>이미지 캐시 쓰기</strong></a> 횟수에 따라 요금이 청구된다 .</li>
</ul>
<p><a href="https://vercel.com/docs/image-optimization#measuring-performance"><strong>Vercel에서 최적화된</strong></a> 모든 이미지에는 다음과 같은 제한이 적용된다.</p>
<ul>
<li>변환된 이미지의 최대 크기는 <a href="https://vercel.com/docs/edge-network/caching#how-to-cache-responses"><strong>캐시 가능한 응답 제한</strong></a> 에 명시된 대로 <strong>10MB</strong></li>
<li>각 소스 이미지의 최대 너비와 높이는 8192픽셀이다.</li>
<li>최적화하려면 원본 이미지가 다음 형식 중 하나여야 한다. <code>image/jpeg, image/png, image/webp, image/avif</code></li>
</ul></div><hr class="my-10"/><section></section></div><!--/$--></article></main><div class="w-full h-32"><footer class="footer footer-center p-10 justify-center"><nav><div class="grid grid-flow-col gap-7"><a title="github" target="_blank" href="https://github.com/gogleset"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="fill-current"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a><a title="email" target="_blank" href="mailto:choij2494@gmail.com"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 75.294 75.294" class="fill-current"><path d="M66.097,12.089h-56.9C4.126,12.089,0,16.215,0,21.286v32.722c0,5.071,4.126,9.197,9.197,9.197h56.9   c5.071,0,9.197-4.126,9.197-9.197V21.287C75.295,16.215,71.169,12.089,66.097,12.089z M61.603,18.089L37.647,33.523L13.691,18.089   H61.603z M66.097,57.206h-56.9C7.434,57.206,6,55.771,6,54.009V21.457l29.796,19.16c0.04,0.025,0.083,0.042,0.124,0.065   c0.043,0.024,0.087,0.047,0.131,0.069c0.231,0.119,0.469,0.215,0.712,0.278c0.025,0.007,0.05,0.01,0.075,0.016   c0.267,0.063,0.537,0.102,0.807,0.102c0.001,0,0.002,0,0.002,0c0.002,0,0.003,0,0.004,0c0.27,0,0.54-0.038,0.807-0.102   c0.025-0.006,0.05-0.009,0.075-0.016c0.243-0.063,0.48-0.159,0.712-0.278c0.044-0.022,0.088-0.045,0.131-0.069   c0.041-0.023,0.084-0.04,0.124-0.065l29.796-19.16v32.551C69.295,55.771,67.86,57.206,66.097,57.206z"></path></svg></a></div></nav></footer></div><script src="https://gogleset.github.io/_next/static/chunks/webpack-14f60f031ad37603.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"https://gogleset.github.io/_next/static/css/cc4162795b3fa97e.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"2:I[5751,[],\"\"]\n5:I[9275,[],\"\"]\n7:I[2864,[\"231\",\"static/chunks/231-e841b6edcc38d627.js\",\"613\",\"static/chunks/app/posts/%5Bid%5D/error-43f6426e3a7526c8.js\"],\"default\"]\n8:I[1343,[],\"\"]\n9:I[8496,[\"231\",\"static/chunks/231-e841b6edcc38d627.js\",\"185\",\"static/chunks/app/layout-c5dcdd748a4b65d7.js\"],\"default\"]\na:I[231,[\"231\",\"static/chunks/231-e841b6edcc38d627.js\",\"185\",\"static/chunks/app/layout-c5dcdd748a4b65d7.js\"],\"\"]\nb:I[6372,[\"231\",\"static/chunks/231-e841b6edcc38d627.js\",\"185\",\"static/chunks/app/layout-c5dcdd748a4b65d7.js\"],\"default\"]\nc:I[1842,[\"231\",\"static/chunks/231-e841b6edcc38d627.js\",\"185\",\"static/chunks/app/layout-c5dcdd748a4b65d7.js\"],\"default\"]\nd:I[6372,[\"231\",\"static/chunks/231-e841b6edcc38d627.js\",\"185\",\"static/chunks/app/layout-c5dcdd748a4b65d7.js\"],\"myDrawer3Close\"]\ne:I[1301,[\"231\",\"static/chunks/231-e841b6edcc38d627.js\",\"185\",\"static/chunks/app/layout-c5dcdd748a4b65d7.js\"],\"default\"]\nf:I[4404,[\"231\",\"static/chunks/231-e841b6edcc38d627.js\",\"185\",\"static/chunks/app/layout-c5dcdd748a4b65d7.js\"],\"GoogleAnalytics\"]\n11:I[6314,[\"231\",\"static/chunks/231-e841b6edcc38d627.js\",\"470\",\"static/chunks/app/global-error-9622828abc1b57c8.js\"],\"default\"]\n6:[\"id\",\"nextImage\",\"d\"]\n12:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"https://gogleset.github.io/_next/static/css/cc4162795b3fa97e.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L2\",null,{\"buildId\":\"DpO-zw4UfbWKBovr8Y_Wh\",\"assetPrefix\":\"https://gogleset.github.io\",\"initialCanonicalUrl\":\"/posts/nextImage\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"nextImage\",\"d\"],{\"children\":[\"__PAGE__?{\\\"id\\\":\\\"nextImage\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"nextImage\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L3\",\"$L4\"],null],null]},[[\"$\",\"div\",null,{\"className\":\"flex flex-col w-full\",\"children\":[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",\"$6\",\"children\"],\"error\":\"$7\",\"errorStyles\":[],\"errorScripts\":[],\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]}],null],null]},[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"ko\",\"data-theme\":\"cupcake\",\"children\":[[\"$\",\"body\",null,{\"children\":[\"$\",\"$L9\",null,{\"children\":[[\"$\",\"header\",null,{\"className\":\" border-gray-200 px-4 lg:px-6 py-3.5  max-h-[68px] w-full sticky top-0 bg-base-100\",\"children\":[\"$\",\"div\",null,{\"className\":\"w-full max-w-[1140px] mx-auto\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-wrap justify-between items-center \",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex gap-3 items-center\",\"children\":[[\"$\",\"$La\",null,{\"href\":\"/\",\"className\":\"self-center text-xl font-semibold whitespace-nowrap cursor-pointer\",\"children\":\"gogleset's note\"}],[\"$\",\"div\",null,{\"className\":\"divider divider-horizontal w-2 max-lg:hidden\"}],[\"$\",\"nav\",null,{\"className\":\"max-lg:hidden\",\"children\":[\"$\",\"$Lb\",null,{}]}]]}],[\"$\",\"div\",null,{\"className\":\"flex gap-4 items-center justify-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex max-lg:hidden\",\"children\":[\"$\",\"$Lc\",null,{}]}],[\"$\",\"div\",null,{\"className\":\"drawer drawer-end lg:hidden\",\"children\":[[\"$\",\"input\",null,{\"id\":\"my-drawer-3\",\"type\":\"checkbox\",\"className\":\"drawer-toggle\"}],[\"$\",\"div\",null,{\"className\":\"drawer-content flex flex-col\",\"children\":[\"$\",\"div\",null,{\"className\":\" w-full p-0\",\"children\":[\"$\",\"div\",null,{\"className\":\"lg:hidden\",\"children\":[\"$\",\"label\",null,{\"htmlFor\":\"my-drawer-3\",\"aria-label\":\"open sidebar\",\"className\":\"cursor-pointer\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"fill\":\"none\",\"viewBox\":\"0 0 24 24\",\"className\":\"inline-block w-8 h-8 stroke-current\",\"children\":[\"$\",\"path\",null,{\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"strokeWidth\":\"2\",\"d\":\"M4 6h16M4 12h16M4 18h16\"}]}]}]}]}]}],[\"$\",\"div\",null,{\"className\":\"drawer-side\",\"children\":[[\"$\",\"label\",null,{\"htmlFor\":\"my-drawer-3\",\"aria-label\":\"close sidebar\",\"className\":\"drawer-overlay\"}],[\"$\",\"div\",null,{\"className\":\"menu p-4 w-80 min-h-full bg-base-200 justify-between\",\"children\":[[\"$\",\"$Lb\",null,{\"col\":true}],[\"$\",\"div\",null,{\"className\":\"flex justify-between\",\"children\":[[\"$\",\"svg\",null,{\"onClick\":\"$d\",\"className\":\"fill-current cursor-pointer\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"40\",\"height\":\"40\",\"viewBox\":\"0 0 512 512\",\"children\":[\"$\",\"polygon\",null,{\"points\":\"400 145.49 366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49\"}]}],[\"$\",\"$Lc\",null,{}]]}]]}]]}]]}]]}]]}],[\"$\",\"$Le\",null,{}]]}]}],[\"$\",\"main\",null,{\"className\":\"flex w-full justify-center items-center flex-col\",\"children\":[\"$\",\"article\",null,{\"className\":\"flex justify-center w-full max-w-[1080px] p-5\",\"children\":[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"section\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"container flex pt-32 min-h-screen  mx-auto\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center max-w-sm mx-auto text-center\",\"children\":[[\"$\",\"p\",null,{\"className\":\"p-3 text-sm font-medium text-current rounded-full  \",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"fill\":\"none\",\"viewBox\":\"0 0 24 24\",\"strokeWidth\":\"2\",\"stroke\":\"currentColor\",\"className\":\"w-6 h-6\",\"children\":[\"$\",\"path\",null,{\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"d\":\"M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z\"}]}]}],[\"$\",\"p\",null,{\"className\":\"mt-3 text-2xl font-semibold md:text-3xl\",\"children\":\"OOPS! \"}],[\"$\",\"h1\",null,{\"className\":\"mt-1 text-xl font-semibold\",\"children\":\"404 page not found\"}],[\"$\",\"$La\",null,{\"href\":\"/\",\"className\":\"mt-10 btn btn-success\",\"children\":\"Home\"}]]}]}]}],\"notFoundStyles\":[],\"styles\":null}]}]}],[\"$\",\"div\",null,{\"className\":\"w-full h-32\",\"children\":[\"$\",\"footer\",null,{\"className\":\"footer footer-center p-10 justify-center\",\"children\":[\"$\",\"nav\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"grid grid-flow-col gap-7\",\"children\":[[\"$\",\"a\",null,{\"title\":\"github\",\"target\":\"_blank\",\"href\":\"https://github.com/gogleset\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\",\"className\":\"fill-current\",\"children\":[\"$\",\"path\",null,{\"d\":\"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z\"}]}]}],[\"$\",\"a\",null,{\"title\":\"email\",\"target\":\"_blank\",\"href\":\"mailto:choij2494@gmail.com\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 75.294 75.294\",\"className\":\"fill-current\",\"children\":[\"$\",\"path\",null,{\"d\":\"M66.097,12.089h-56.9C4.126,12.089,0,16.215,0,21.286v32.722c0,5.071,4.126,9.197,9.197,9.197h56.9   c5.071,0,9.197-4.126,9.197-9.197V21.287C75.295,16.215,71.169,12.089,66.097,12.089z M61.603,18.089L37.647,33.523L13.691,18.089   H61.603z M66.097,57.206h-56.9C7.434,57.206,6,55.771,6,54.009V21.457l29.796,19.16c0.04,0.025,0.083,0.042,0.124,0.065   c0.043,0.024,0.087,0.047,0.131,0.069c0.231,0.119,0.469,0.215,0.712,0.278c0.025,0.007,0.05,0.01,0.075,0.016   c0.267,0.063,0.537,0.102,0.807,0.102c0.001,0,0.002,0,0.002,0c0.002,0,0.003,0,0.004,0c0.27,0,0.54-0.038,0.807-0.102   c0.025-0.006,0.05-0.009,0.075-0.016c0.243-0.063,0.48-0.159,0.712-0.278c0.044-0.022,0.088-0.045,0.131-0.069   c0.041-0.023,0.084-0.04,0.124-0.065l29.796-19.16v32.551C69.295,55.771,67.86,57.206,66.097,57.206z\"}]}]}]]}]}]}]}]]}]}],[\"$\",\"$Lf\",null,{\"gaId\":\"$undefined\"}]]}],null],[[\"$\",\"div\",null,{\"className\":\"flex pt-1 min-h-screen\",\"children\":[\"$\",\"div\",null,{\"className\":\"loading loading-infinity loading-lg \"}]}],[],[]]],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$L10\"],\"globalErrorComponent\":\"$11\",\"missingSlots\":\"$W12\"}]]\n"])</script><script>self.__next_f.push([1,"13:I[3556,[\"173\",\"static/chunks/173-085cf89c21a1457b.js\",\"722\",\"static/chunks/app/posts/%5Bid%5D/page-ed3992e816e0c12e.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"4:[[[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-center h-64 gap-3\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-3xl max-lg:text-2xl font-bold text-center\",\"children\":\"Next.js Image 어떻게 최적화 할까?\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-center gap-1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-gray\",\"children\":\"2025-04-23\"}],[\"$\",\"div\",null,{\"className\":\"flex gap-1 \",\"children\":[[\"$\",\"span\",\"Next_0\",{\"className\":\"badge badge-accent\",\"children\":\"Next\"}],[\"$\",\"span\",\"Image_1\",{\"className\":\"badge badge-accent\",\"children\":\"Image\"}]]}]]}]]}],[\"$\",\"hr\",null,{\"className\":\"mb-[0px]\"}]],[\"$\",\"div\",null,{\"className\":\"flex flex-col prose max-w-full max-sm:prose-sm \",\"children\":[[\"$\",\"h1\",null,{\"id\":\"toc\",\"children\":\"toc\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#nextjs-image-%EC%B5%9C%EC%A0%81%ED%99%94\",\"children\":\"Next.js Image 최적화\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EC%99%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%EA%B0%80\",\"children\":\"왜 사용하는가?\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-%ED%8F%AC%EB%A7%B7-%EB%B9%84%EA%B5%90-%ED%91%9C\",\"children\":\"이미지 포맷 비교 표\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EC%B0%B8%EA%B3%A0-mime-type-vs-content-type\",\"children\":\"참고) MIME Type vs Content-Type\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#nextjs-image-%EC%9A%94%EC%B2%AD-%EC%B2%98%EB%A6%AC-%ED%9D%90%EB%A6%84\",\"children\":\"Next.js Image 요청 처리 흐름\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EC%A3%BC%EC%9A%94-%ED%8C%8C%EC%9D%BC\",\"children\":\"주요 파일\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#server\",\"children\":\"Server\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#image-optimizerts\",\"children\":\"image-optimizer.ts\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EC%A7%80%EC%9B%90%ED%95%98%EB%8A%94-%ED%98%95%EC%8B%9D%EC%9C%BC%EB%A1%9C%EC%9D%98-%ED%8F%AC%EB%A7%B7-%EB%B3%80%ED%99%98\",\"children\":\"지원하는 형식으로의 포맷 변환\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%B5%9C%EC%A0%81%ED%99%94-%EC%A3%BC%EC%9A%94-%EC%B2%98%EB%A6%AC\",\"children\":\"이미지 최적화 주요 처리\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#nextjs%EA%B0%80-%EA%B4%80%EB%A6%AC%ED%95%98%EB%8A%94-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%86%8D%EC%84%B1%EA%B0%92%EB%93%A4\",\"children\":\"Next.js가 관리하는 이미지 속성값들\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EC%A7%80%EC%9B%90%EB%90%98%EC%A7%80-%EC%95%8A%EB%8A%94-%EC%9D%B4%EB%AF%B8%EC%A7%80\",\"children\":\"지원되지 않는 이미지\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#contenttype-%EA%B2%B0%EC%A0%95\",\"children\":\"contentType 결정\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%B5%9C%EC%A0%81%ED%99%94\",\"children\":\"이미지 최적화\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EC%A3%BC%EC%9A%94-%EC%B2%98%EB%A6%AC\",\"children\":\"주요 처리:\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EC%8B%A4%ED%97%98%EC%A0%81-%EC%98%B5%EC%85%98sharp%EC%97%90%EC%84%9C-%EC%A7%80%EC%9B%90\",\"children\":\"실험적 옵션(sharp에서 지원)\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#%EC%BA%90%EC%8B%B1-%EC%B2%98%EB%A6%AC\",\"children\":\"캐싱 처리\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EC%BA%90%EC%8B%9C-%EC%A0%80%EC%9E%A5-%EB%B0%A9%EC%8B%9D\",\"children\":\"캐시 저장 방식\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#next-serverts\",\"children\":\"next-server.ts\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#handlenextimagerequest%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%9A%94%EC%B2%AD-%ED%95%B8%EB%93%A4%EB%9F%AC\",\"children\":\"handleNextImageRequest(이미지 요청 핸들러)\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%B5%9C%EC%A0%81%ED%99%94-%EC%BA%90%EC%8B%9C-%ED%81%B4%EB%9E%98%EC%8A%A4\",\"children\":\"이미지 최적화 캐시 클래스\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#imageoptimizer\",\"children\":\"imageOptimizer\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#client\",\"children\":\"Client\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#image-externalts\",\"children\":\"image-external.ts\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#defaultloader\",\"children\":\"defaultLoader\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#getimgprops\",\"children\":\"getImgProps\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#generateattrs\",\"children\":\"generateAttrs\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#image\",\"children\":\"\u003cImage/\u003e\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#image-%EC%BA%90%EC%8B%B1-%EC%A0%95%EC%B1%85\",\"children\":\"Image 캐싱 정책\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#vercel-%EB%B0%B0%ED%8F%AC-%EC%8B%9C-%EC%A3%BC%EC%9D%98%EC%A0%9020254%EC%9B%94-%EA%B8%B0%EC%A4%80\",\"children\":\"Vercel 배포 시 주의점(2025.4월 기준)\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"nextjs-image-최적화\",\"children\":\"Next.js Image 최적화\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"(2025.4 Canary 버전 기준)\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"왜-사용하는가\",\"children\":\"왜 사용하는가?\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"크기 최적화\"}],\": 웹 친화적인 이미지 포맷으로 변환 (AVIF, WEBP 등)\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"이미지-포맷-비교-표\",\"children\":\"이미지 포맷 비교 표\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"특성\"}],[\"$\",\"th\",null,{\"children\":\"AVIF\"}],[\"$\",\"th\",null,{\"children\":\"JPG/JPEG\"}],[\"$\",\"th\",null,{\"children\":\"PNG\"}],[\"$\",\"th\",null,{\"children\":\"WebP\"}],[\"$\",\"th\",null,{\"children\":\"MozJPEG\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"개발자\"}],[\"$\",\"td\",null,{\"children\":\"Alliance for Open Media\"}],[\"$\",\"td\",null,{\"children\":\"Joint Photographic Experts Group\"}],[\"$\",\"td\",null,{\"children\":\"PNG Development Group\"}],[\"$\",\"td\",null,{\"children\":\"Google\"}],[\"$\",\"td\",null,{\"children\":\"Mozilla\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"압축 방식\"}],[\"$\",\"td\",null,{\"children\":\"손실/무손실\"}],[\"$\",\"td\",null,{\"children\":\"손실\"}],[\"$\",\"td\",null,{\"children\":\"무손실\"}],[\"$\",\"td\",null,{\"children\":\"손실/무손실\"}],[\"$\",\"td\",null,{\"children\":\"손실\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"파일 크기\"}],[\"$\",\"td\",null,{\"children\":\"매우 작음\"}],[\"$\",\"td\",null,{\"children\":\"중간\"}],[\"$\",\"td\",null,{\"children\":\"큼\"}],[\"$\",\"td\",null,{\"children\":\"작음\"}],[\"$\",\"td\",null,{\"children\":\"중간-작음\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"이미지 품질\"}],[\"$\",\"td\",null,{\"children\":\"매우 높음\"}],[\"$\",\"td\",null,{\"children\":\"중간-높음\"}],[\"$\",\"td\",null,{\"children\":\"매우 높음\"}],[\"$\",\"td\",null,{\"children\":\"높음\"}],[\"$\",\"td\",null,{\"children\":\"높음\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"투명도 지원\"}],[\"$\",\"td\",null,{\"children\":\"지원\"}],[\"$\",\"td\",null,{\"children\":\"미지원\"}],[\"$\",\"td\",null,{\"children\":\"지원\"}],[\"$\",\"td\",null,{\"children\":\"지원\"}],[\"$\",\"td\",null,{\"children\":\"미지원\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"애니메이션\"}],[\"$\",\"td\",null,{\"children\":\"지원\"}],[\"$\",\"td\",null,{\"children\":\"미지원\"}],[\"$\",\"td\",null,{\"children\":\"미지원(APNG 제외)\"}],[\"$\",\"td\",null,{\"children\":\"지원\"}],[\"$\",\"td\",null,{\"children\":\"미지원\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"브라우저 호환성\"}],[\"$\",\"td\",null,{\"children\":\"제한적\"}],[\"$\",\"td\",null,{\"children\":\"매우 높음\"}],[\"$\",\"td\",null,{\"children\":\"매우 높음\"}],[\"$\",\"td\",null,{\"children\":\"높음\"}],[\"$\",\"td\",null,{\"children\":\"매우 높음\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"적합한 용도\"}],[\"$\",\"td\",null,{\"children\":\"웹 이미지, 사진\"}],[\"$\",\"td\",null,{\"children\":\"사진, 웹 이미지\"}],[\"$\",\"td\",null,{\"children\":\"로고, 아이콘, 스크린샷\"}],[\"$\",\"td\",null,{\"children\":\"웹 이미지, 애니메이션\"}],[\"$\",\"td\",null,{\"children\":\"최적화된 웹 사진\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"색상 깊이\"}],[\"$\",\"td\",null,{\"children\":\"8-12비트\"}],[\"$\",\"td\",null,{\"children\":\"8비트\"}],[\"$\",\"td\",null,{\"children\":\"8-16비트\"}],[\"$\",\"td\",null,{\"children\":\"8비트\"}],[\"$\",\"td\",null,{\"children\":\"8비트\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"HDR 지원\"}],[\"$\",\"td\",null,{\"children\":\"지원\"}],[\"$\",\"td\",null,{\"children\":\"미지원\"}],[\"$\",\"td\",null,{\"children\":\"미지원\"}],[\"$\",\"td\",null,{\"children\":\"제한적\"}],[\"$\",\"td\",null,{\"children\":\"미지원\"}]]}]]}]]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"웹사이트 성능 최적화: AVIF나 WebP\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"호환성: JPG나 PNG\"}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"참고-mime-type-vs-contenttype\",\"children\":\"참고) MIME Type vs Content-Type\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"항목\"}],[\"$\",\"th\",null,{\"children\":\"MIME 타입\"}],[\"$\",\"th\",null,{\"children\":\"Content-Type\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"정의\"}],[\"$\",\"td\",null,{\"children\":\"파일 형식 식별을 위한 표준\"}],[\"$\",\"td\",null,{\"children\":\"HTTP 응답의 리소스 타입 명시\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"사용 범위\"}],[\"$\",\"td\",null,{\"children\":\"이메일, 웹, 프로그램 등 광범위\"}],[\"$\",\"td\",null,{\"children\":\"HTTP 통신에서 주로 사용\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"포함 정보\"}],[\"$\",\"td\",null,{\"children\":[\"타입/서브타입 (예: \",[\"$\",\"code\",null,{\"children\":\"text/html\"}],\")\"]}],[\"$\",\"td\",null,{\"children\":\"MIME 타입 + 선택 파라미터\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"예시\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"image/jpeg\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Content-Type: image/jpeg; charset=UTF-8\"}]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"독립성\"}],[\"$\",\"td\",null,{\"children\":\"다양한 프로토콜에서 사용\"}],[\"$\",\"td\",null,{\"children\":\"HTTP 헤더의 일부로 한정\"}]]}]]}]]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"nextjs-image-요청-처리-흐름\",\"children\":\"Next.js Image 요청 처리 흐름\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"브라우저가 \",[\"$\",\"code\",null,{\"children\":\"/_next/image/...\"}],\" 경로로 요청\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"handleNextImageRequest\"}],\"에서 요청 라우팅\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"파라미터 검증 및 캐시 확인\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"캐시가 있다면 반환\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"없다면 \",[\"$\",\"code\",null,{\"children\":\"imageOptimizer\"}],\" 호출하여 최적화 수행 후 캐시에 저장\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"주요-파일\",\"children\":\"주요 파일\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"next-server.ts (server)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"image-optimizer.ts (server)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"image-external.ts (client)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"image-component.ts(client)\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"server\",\"children\":\"Server\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"imageoptimizerts\",\"children\":\"image-optimizer.ts\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"지원하는-형식으로의-포맷-변환\",\"children\":\"지원하는 형식으로의 포맷 변환\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"getSupportedMimeType\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"options\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" accept \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" mimeType \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"mediaType\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"accept\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" options\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" accept\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"includes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"mimeType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?\"}],\" mimeType \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" mimeType \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"getSupportedMimeType\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"formats \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" req\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"headers\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"accept\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"header에서 accept를 추출하여 브라우저에서 지원하는 값을 추출하고, 이 options 는\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"/** @type {import('next').NextConfig} */\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" nextConfig \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  images\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    formats\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/avif\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/webp\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"default\"}],\" nextConfig\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"여기 작성한 formats 옵션이 들어간다. 기본값은 \",[\"$\",\"a\",null,{\"href\":\"https://github.com/vercel/next.js/blob/canary/packages/next/src/server/image-optimizer.ts#L220\",\"children\":\"[image/webp]\"}],\"이다. 지원하지 않으면 원본 포맷을 유지한다.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"이미지-최적화-주요-처리\",\"children\":\"이미지 최적화 주요 처리\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"nextjs가-관리하는-이미지-속성값들\",\"children\":\"Next.js가 관리하는 이미지 속성값들\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-ts\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-ts code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"AVIF\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/avif\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"WEBP\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/webp\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"PNG\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/png\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"JPEG\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/jpeg\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"GIF\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/gif\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"SVG\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/svg+xml\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"ICO\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/x-icon\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"ICNS\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/x-icns\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"TIFF\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/tiff\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"BMP\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/bmp\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"ANIMATABLE_TYPES\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"WEBP\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"PNG\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"GIF\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 움직일만한 타입(PNG는 APNG라는 포맷이 있다.)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"BYPASS_TYPES\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"SVG\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"ICO\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"ICNS\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"BMP\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 최적화 안해주는 타입들\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"지원되지-않는-이미지\",\"children\":\"지원되지 않는 이미지\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"upstreamType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"startsWith\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"image/svg\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\u0026\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"nextConfig\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"images\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"dangerouslyAllowSVG\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"SVG는 \",[\"$\",\"code\",null,{\"children\":\"dangerouslyAllowSVG\"}],\" 설정이 꺼져 있으면 에러 반환\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"ANIMATABLE_TYPES\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"includes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"upstreamType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\u0026\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"isAnimated\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"upstreamBuffer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"애니메이션 이미지(WEBP, PNG(APNG), GIF)는 최적화하지 않고 원본 반환\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"BYPASS_TYPES\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"includes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"upstreamType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"최적화 대상에서 제외 (SVG, ICO, ICNS, BMP 등)\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"contenttype-결정\",\"children\":\"contentType 결정\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" contentType \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" mimeType \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"??\"}],\" upstreamType \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"??\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"JPEG\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"MIME 타입 \u003e upstreamType \u003e 기본값 JPEG 순서로 지정\"}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"이미지-최적화\",\"children\":\"이미지 최적화\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"let\"}],\" optimizedBuffer \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"optimizeImage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  buffer\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" upstreamBuffer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  contentType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  quality\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  width\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  concurrency\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" nextConfig\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"experimental\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"imgOptConcurrency\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  limitInputPixels\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" nextConfig\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"experimental\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"imgOptMaxInputPixels\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  sequentialRead\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" nextConfig\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"experimental\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"imgOptSequentialRead\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  timeoutInSeconds\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" nextConfig\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"experimental\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"imgOptTimeoutInSeconds\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  buffer\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" optimizedBuffer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  contentType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  maxAge\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  etag\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"getImageEtag\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"optimizedBuffer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  upstreamEtag\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"optimizedBuffer를 받게된다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"optimizeImage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"주요-처리\",\"children\":\"주요 처리:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"sharp\"}],\" 라이브러리 사용(squoosh는 제외됨)\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"사이즈 조절: \",[\"$\",\"code\",null,{\"children\":\"resize(width, height)\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"포맷별 설정:\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"AVIF: \",[\"$\",\"code\",null,{\"children\":\"quality - 20\"}],\", \",[\"$\",\"code\",null,{\"children\":\"effort: 3\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"WEBP, PNG, JPEG: 각 포맷에 맞는 옵션 적용\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"최종 버퍼 반환\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"실험적-옵션sharp에서-지원\",\"children\":\"실험적 옵션(sharp에서 지원)\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"옵션명\"}],[\"$\",\"th\",null,{\"children\":\"설명\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"concurrency\"}]}],[\"$\",\"td\",null,{\"children\":\"동시 최적화 제한\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"limitInputPixels\"}]}],[\"$\",\"td\",null,{\"children\":\"입력 이미지 픽셀 제한\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"sequentialRead\"}]}],[\"$\",\"td\",null,{\"children\":\"순차 읽기 활성화 여부\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"timeoutInSeconds\"}]}],[\"$\",\"td\",null,{\"children\":\"최적화 타임아웃 설정\"}]]}]]}]]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"캐싱-처리\",\"children\":\"캐싱 처리\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"캐시-저장-방식\",\"children\":\"캐시 저장 방식\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"writeToCacheDir\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" filename \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    dir\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"maxAge\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"expireAt\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"etag\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"upstreamEtag\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"extension\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" promises\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"writeFile\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"filename\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" buffer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"이미지 캐시 파일명은 정보 기반으로 구성\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"nextserverts\",\"children\":\"next-server.ts\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"handlenextimagerequest이미지-요청-핸들러\",\"children\":\"handleNextImageRequest(이미지 요청 핸들러)\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// URL 경로가 없거나 '/_next/image'로 시작하지 않으면 처리하지 않음\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"parsedUrl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"pathname\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"parsedUrl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"pathname\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"startsWith\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'/_next/image'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 미들웨어 요청이면 처리하지 않음\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"getRequestMeta\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"req\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'middlewareInvoke'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"     \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 최소 모드이거나 정적 내보내기 모드일 경우 이미지 최적화를 처리하지 않고 400 오류 반환\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"this\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"minimalMode\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"this\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"nextConfig\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"output\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"===\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'export'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      process\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"env\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"NEXT_MINIMAL\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"이미지-최적화-캐시-클래스\",\"children\":\"이미지 최적화 캐시 클래스\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" imageOptimizerCache \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"ImageOptimizerCache\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  distDir\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"this\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"distDir\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  nextConfig\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"this\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"nextConfig\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"최적화된 이미지가 저장되는 디렉토리를 관리하는 클래스\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"이미지 최적화 캐시 인스턴스 생성\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" paramsResult \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ImageOptimizerCache\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"validateParams\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" cacheKey \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ImageOptimizerCache\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"getCacheKey\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"paramsResult\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"이미지 최적화 캐시 클래스에서 이미지 검증과 캐시 키를 가져옴\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"   \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" cacheEntry \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"this\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"imageResponseCache\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"get\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          cacheKey\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" previousCacheEntry \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" buffer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" contentType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" maxAge\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" upstreamEtag\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" etag \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"              \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"this\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"imageOptimizer\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"              \",[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"              \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"         \",[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            routeKind\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"RouteKind\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"IMAGE\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            incrementalCache\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" imageOptimizerCache\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            isFallback\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"key\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"responseGenerator\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" hasResolved\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" previousCacheEntry\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"null\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"이런식으로 imageOtimizer를 this.imageResponseCache.get에서 활용하고 있다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"imageoptimizer\",\"children\":\"imageOptimizer\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"protected\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"imageOptimizer\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 절대 루트인지 확인해서 외부 이미지, 내부이미지 구분\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" imageUpstream \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" isAbsolute\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"fetchExternalImage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"href\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"fetchInternalImage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            href\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            req\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"originalRequest\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"            res\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"originalResponse\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"            handleInternalReq\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"\\t\\t\\t\\t\",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"//image-optimizer.ts에 있는 함수\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"imageOptimizer\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"imageUpstream\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" paramsResult\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"this\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"nextConfig\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        isDev\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"this\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"renderOpts\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"dev\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        previousCacheEntry\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"외부 URL → \",[\"$\",\"code\",null,{\"children\":\"fetchExternalImage(href)\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"내부 URL → \",[\"$\",\"code\",null,{\"children\":\"fetchInternalImage(...)\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"이후 최적화 수행 및 캐시 저장\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"client\",\"children\":\"Client\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"imageexternalts\",\"children\":\"image-external.ts\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"getImageProps\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"imgProps\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ImageProps\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"default\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Image\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"type\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ImageProps\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ImageLoaderProps\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ImageLoader\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"StaticImageData\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"기본적으로 Image 컴포넌트를 내보내고, 타입과 getImageProps 함수를 내보낸다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"defaultloader\",\"children\":\"defaultLoader\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"next image의 src path 리턴\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"type\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ImageLoaderPropsWithConfig\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"./image-config\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"DEFAULT_Q\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"75\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"defaultLoader\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  width\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  quality\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ImageLoaderPropsWithConfig\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 이미지 유효성 확인 로직\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" q \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    quality \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// image 퀄리티를 제한하려면 next.config에 구성을 추가할 수 있습니다.\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"qualities\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?.\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"reduce\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"prev\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" cur\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token known-class-name class-name\",\"children\":\"Math\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"abs\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"cur \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"DEFAULT_Q\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token known-class-name class-name\",\"children\":\"Math\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"abs\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"prev \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"DEFAULT_Q\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?\"}],\" cur \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" prev\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"DEFAULT_Q\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"path\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"?url=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"encodeURIComponent\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\u0026w=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"width\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\u0026q=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"q\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"\\n\"]}]]}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[\"    src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"startsWith\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"/_next/static/media/\\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\u0026\"}],\" process\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"env\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"NEXT_DEPLOYMENT_ID\"}],\"\\n\"]}]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\u0026dpl=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"process\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"env\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"NEXT_DEPLOYMENT_ID\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],\"\\n\"]}]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"\\\"\"}],\"\\n\"]}]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// We use this to determine if the import is the default loader\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// or a custom loader defined by the user in next.config.js\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"defaultLoader\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"__next_img_default\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"true\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"default\"}],\" defaultLoader\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"사용자가 직접 \",[\"$\",\"code\",null,{\"children\":\"quality\"}],\"를 지정했다면 그걸 쓰고, 지정 안 했다면 \",[\"$\",\"code\",null,{\"children\":\"config.qualities\"}],\" 목록에서 75와 가장 가까운 걸 골라서 쓰고, 그것도 없으면 기본값인 \",[\"$\",\"code\",null,{\"children\":\"75\"}],\"를 사용한다.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"DEFAULT_Q\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"75\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" qualities \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"60\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"70\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"80\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"90\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" closestQuality \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" qualities\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"reduce\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"prev\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" cur\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" prevDiff \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token known-class-name class-name\",\"children\":\"Math\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"abs\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"prev \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"DEFAULT_Q\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" curDiff \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token known-class-name class-name\",\"children\":\"Math\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"abs\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"cur \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"DEFAULT_Q\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token known-class-name class-name\",\"children\":\"Math\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"abs\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"cur \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"DEFAULT_Q\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token known-class-name class-name\",\"children\":\"Math\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"abs\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"prev \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"DEFAULT_Q\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?\"}],\" cur \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" prev\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token console class-name\",\"children\":\"console\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"log\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"closestQuality\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"확인해보기\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"getimgprops\",\"children\":\"getImgProps\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"getImgProps\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ImageProps\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" _state\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    props\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" 실제 \",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c\"}],\"img\"]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],[\"$\",\"span\",null,{\"className\":\"token plain-text\",\"children\":\" 태그에 들어갈 최종 속성들,\\n\"}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token plain-text\",\"children\":\"    meta: \"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      unoptimized\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"boolean\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 최적화 비활성화 여부\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      priority\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"boolean\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 우선 로딩 여부\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      placeholder\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'blur'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"|\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'empty'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 플레이스홀더 타입\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      fill\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"boolean\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 부모 요소에 맞게 꽉 채울지 여부\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token plain-text\",\"children\":\"\\n\"}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token plain-text\",\"children\":\"  }\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token plain-text\",\"children\":\"}\\n\"}]}]]}]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 예외 처리 및 이미지 스타일, 백그라운드 이미지, 사이즈 속성이 설정된 후\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" imgAttributes \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"generateImgAttrs\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  unoptimized\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  width\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" widthInt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  quality\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" qualityInt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  sizes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  loader\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Image의 src, sizes, srcSet을 결정하는 generateImgAttrs를 통과한다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"generateattrs\",\"children\":\"generateAttrs\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"generateImgAttrs\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  unoptimized\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  width\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  quality\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  sizes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  loader\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"GenImgAttrsData\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"GenImgAttrsResult\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"unoptimized\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" srcSet\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"undefined\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" sizes\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"undefined\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// size가 있는 경우 sizes 또는 width 값을 기준으로 적절한 width 목록을 계산\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// width가 있는 경우, kind:x (배율계산)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// size, width가 없다면 deviceSize를 씀\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" widths\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" kind \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"getWidths\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" width\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" sizes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" last \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" widths\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"length\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// kind는 w(width), x(배율)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    sizes\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"sizes \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\u0026\"}],\" kind \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"===\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"w\\\"\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"100vw\\\"\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" sizes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    srcSet\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" widths\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"map\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"w\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" i\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"loader\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" quality\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" width\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" w \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\" \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"\\n\"]}]]}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[\"            kind \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"===\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"w\\\"\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?\"}],\" w \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" i \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1\"}],\"\\n\"]}]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[\"          \",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"kind\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"join\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\", \\\"\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    src\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"loader\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" quality\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" width\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" widths\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"last\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"return\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" props\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ImgProps\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"rest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  loading\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" isLazy \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"lazy\\\"\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" loading\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  fetchPriority\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  width\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" widthInt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  height\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" heightInt\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  decoding\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  className\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  style\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"imgStyle\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"placeholderStyle \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  sizes\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" imgAttributes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"sizes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  srcSet\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" imgAttributes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"srcSet\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  src\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" overrideSrc \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\" imgAttributes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"src\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" meta \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" unoptimized\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" priority\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" placeholder\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" fill \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" props\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" meta \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"이로써 최종 Image 컴포넌트로의 속성들이 결정된다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"image\",\"children\":\"\u003cImage/\u003e\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"Image\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token generic-function\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"forwardRef\"}],[\"$\",\"span\",null,{\"className\":\"token generic class-name\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\"HTMLImageElement \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"|\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"null\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" ImageProps\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}]]}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"props\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" forwardedRef\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" isAppRouter \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"pagesRouter\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" configContext \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"useContext\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token maybe-class-name\",\"children\":\"ImageConfigContext\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// config를 가져옴\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" config \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"useMemo\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" c \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" configEnv \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\" configContext \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\" imageConfigDefault\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" allSizes \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"deviceSizes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"imageSizes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"sort\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"a\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" b\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\" a \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" b\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" deviceSizes \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"deviceSizes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"sort\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"a\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" b\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\" a \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" b\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" qualities \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"qualities\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?.\"}],[\"$\",\"span\",null,{\"className\":\"token method function property-access\",\"children\":\"sort\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"a\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" b\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token arrow operator\",\"children\":\"=\u003e\"}],\" a \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" b\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"c\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" allSizes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" deviceSizes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" qualities \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"configContext\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" props\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" imgAttributes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" meta\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" imgMeta \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"getImgProps\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"props\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      defaultLoader\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      imgConf\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" config\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      blurComplete\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      showAltText\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"   \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":\"\\n\"}]]}]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],[\"$\",\"span\",null,{\"className\":\"token plain-text\",\"children\":\"\\n\"}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token plain-text\",\"children\":\"    \"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"ImageElement\"}]]}],\"\\n\"]}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token spread\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token spread operator\",\"children\":\"...\"}],\"imgAttributes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token attr-name\",\"children\":\"unoptimized\"}],[\"$\",\"span\",null,{\"className\":\"token script language-javascript\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token script-punctuation punctuation\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"imgMeta\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"unoptimized\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token attr-name\",\"children\":\"placeholder\"}],[\"$\",\"span\",null,{\"className\":\"token script language-javascript\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token script-punctuation punctuation\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"imgMeta\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"placeholder\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token attr-name\",\"children\":\"fill\"}],[\"$\",\"span\",null,{\"className\":\"token script language-javascript\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token script-punctuation punctuation\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"imgMeta\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"fill\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token attr-name\",\"children\":\"onLoadRef\"}],[\"$\",\"span\",null,{\"className\":\"token script language-javascript\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token script-punctuation punctuation\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"onLoadRef\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token attr-name\",\"children\":\"onLoadingCompleteRef\"}],[\"$\",\"span\",null,{\"className\":\"token script language-javascript\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token script-punctuation punctuation\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"onLoadingCompleteRef\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token attr-name\",\"children\":\"setBlurComplete\"}],[\"$\",\"span\",null,{\"className\":\"token script language-javascript\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token script-punctuation punctuation\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"setBlurComplete\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token attr-name\",\"children\":\"setShowAltText\"}],[\"$\",\"span\",null,{\"className\":\"token script language-javascript\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token script-punctuation punctuation\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"setShowAltText\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token attr-name\",\"children\":\"sizesInput\"}],[\"$\",\"span\",null,{\"className\":\"token script language-javascript\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token script-punctuation punctuation\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"props\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"sizes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token attr-name\",\"children\":\"ref\"}],[\"$\",\"span\",null,{\"className\":\"token script language-javascript\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token script-punctuation punctuation\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"forwardedRef\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"/\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token plain-text\",\"children\":\"\\n\"}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"$\",\"span\",null,{\"className\":\"token plain-text\",\"children\":\"    // 미리 로드\\n\"}]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token plain-text\",\"children\":\"    \"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"imgMeta\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"priority\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"ImagePreload\"}]]}],\" \",[\"$\",\"span\",null,{\"className\":\"token attr-name\",\"children\":\"isAppRouter\"}],[\"$\",\"span\",null,{\"className\":\"token script language-javascript\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token script-punctuation punctuation\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"isAppRouter\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\" \",[\"$\",\"span\",null,{\"className\":\"token attr-name\",\"children\":\"imgAttributes\"}],[\"$\",\"span\",null,{\"className\":\"token script language-javascript\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token script-punctuation punctuation\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"imgAttributes\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"/\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"null\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token plain-text\",\"children\":\"\\n\"}]]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token plain-text\",\"children\":\"  \"}],[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c/\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003e\"}]]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"imgMeta.priority 속성을 활용해 Preload 판단을 하고, preload를 한다\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"App router라면 ReactDom.Preload를 활용해 preload를 한다\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"아니라면, Head 컴포넌트를 사용하여 preload\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"번외\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"image-캐싱-정책\",\"children\":\"Image 캐싱 정책\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"이미지 캐싱 위치\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"이미지는 요청 시 실시간으로 최적화되며, 결과는 \",[\"$\",\"code\",null,{\"children\":\"/.next/cache/images\"}],\" 폴더에 저장된다.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"저장된 이미지는 만료될 때까지 반복해서 사용된다.\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"만료되었을 때\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"만료된 이미지 요청 시, \",[\"$\",\"strong\",null,{\"children\":\"바로 이전 이미지(STALE)를 먼저 응답\"}],\"하고, \",[\"$\",\"strong\",null,{\"children\":\"백그라운드에서 새로 최적화\"}],\"해서 캐시에 다시 저장한다 → \",[\"$\",\"code\",null,{\"children\":\"revalidation\"}]]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"응답 헤더로 캐시 상태 확인 가능\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"x-nextjs-cache\"}],\" 헤더 값으로 확인 가능:\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"MISS\"}],\": 캐시에 없음 (첫 요청 시)\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"STALE\"}],\": 만료된 이미지지만 즉시 응답하고 백그라운드 재검증 중\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"HIT\"}],\": 유효한 캐시 이미지로 응답\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"캐시 만료 기준\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"minimumCacheTTL\"}],\"과 원본 이미지의 \",[\"$\",\"code\",null,{\"children\":\"Cache-Control\"}],\" 헤더의 \",[\"$\",\"code\",null,{\"children\":\"max-age\"}],\" 중 \",[\"$\",\"strong\",null,{\"children\":\"더 큰 값\"}],\"이 사용된다.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"s-maxage\"}],\"가(CDN, proxy) 있으면 \",[\"$\",\"code\",null,{\"children\":\"max-age\"}],\"보다 우선된다.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"이 값은 CDN, 브라우저 등 downstream 클라이언트에게도 전달된다.\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"minimumCacheTTL 설정\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"기본값: \",[\"$\",\"code\",null,{\"children\":\"60초\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"설정 예:\",\"\\n\",[\"$\",\"pre\",null,{\"className\":\"language-tsx\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-tsx code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"module\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"exports\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  images\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"    minimumCacheTTL\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2678400\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 31일\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"TTL(Time To Live - 캐시의 수명)이 낮으면 캐시 재검증이 자주 일어나지만 변경 사항 반영이 빠르다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"TTL이 높으면 비용 절감에는 유리하지만 캐시 무효화가 어렵다.\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"주의 사항\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"개별 이미지의 캐시를 무효화하려면 \",[\"$\",\"code\",null,{\"children\":\"src\"}],\"를 변경하거나 \",[\"$\",\"code\",null,{\"children\":\".next/cache/images\"}],\" 폴더를 직접 삭제\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"/_next/image\"}],\"가 아닌 실제 원본 이미지(\",[\"$\",\"code\",null,{\"children\":\"/some-asset.jpg\"}],\")의 \",[\"$\",\"code\",null,{\"children\":\"Cache-Control\"}],\" 헤더를 설정하여 캐시 전략을 개별적으로 제어할 수 있음.\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"vercel-배포-시-주의점20254월-기준\",\"children\":\"Vercel 배포 시 주의점(2025.4월 기준)\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"항목\"}],[\"$\",\"th\",null,{\"children\":\"hobby 포함\"}],[\"$\",\"th\",null,{\"children\":\"pro 포함\"}],[\"$\",\"th\",null,{\"children\":\"Pro/Enterprise 추가 요금\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"이미지 변환\"}],[\"$\",\"td\",null,{\"children\":\"5천 달러/월\"}],[\"$\",\"td\",null,{\"children\":\"1만 달러/월\"}],[\"$\",\"td\",null,{\"children\":\"1K당 $0.05 - $0.0812\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"이미지 캐시 읽기\"}],[\"$\",\"td\",null,{\"children\":\"30만/월\"}],[\"$\",\"td\",null,{\"children\":\"60만/월\"}],[\"$\",\"td\",null,{\"children\":\"1M당 $0.40 - $0.64\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"이미지 캐시 쓰기\"}],[\"$\",\"td\",null,{\"children\":\"10만/월\"}],[\"$\",\"td\",null,{\"children\":\"20만/월\"}],[\"$\",\"td\",null,{\"children\":\"1M당 $4.00 - $6.40\"}]]}]]}]]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"https://vercel.com/docs/image-optimization/limits-and-pricing#image-transformations\",\"children\":[\"$\",\"strong\",null,{\"children\":\"이미지 변환\"}]}],\" , \",[\"$\",\"a\",null,{\"href\":\"https://vercel.com/docs/image-optimization/limits-and-pricing#image-cache-reads\",\"children\":[\"$\",\"strong\",null,{\"children\":\"이미지 캐시 읽기\"}]}],\" , \",[\"$\",\"a\",null,{\"href\":\"https://vercel.com/docs/image-optimization/limits-and-pricing#image-cache-writes\",\"children\":[\"$\",\"strong\",null,{\"children\":\"이미지 캐시 쓰기\"}]}],\" 횟수에 따라 요금이 청구된다 .\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"https://vercel.com/docs/image-optimization#measuring-performance\",\"children\":[\"$\",\"strong\",null,{\"children\":\"Vercel에서 최적화된\"}]}],\" 모든 이미지에는 다음과 같은 제한이 적용된다.\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"변환된 이미지의 최대 크기는 \",[\"$\",\"a\",null,{\"href\":\"https://vercel.com/docs/edge-network/caching#how-to-cache-responses\",\"children\":[\"$\",\"strong\",null,{\"children\":\"캐시 가능한 응답 제한\"}]}],\" 에 명시된 대로 \",[\"$\",\"strong\",null,{\"children\":\"10MB\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"각 소스 이미지의 최대 너비와 높이는 8192픽셀이다.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"최적화하려면 원본 이미지가 다음 형식 중 하나여야 한다. \",[\"$\",\"code\",null,{\"children\":\"image/jpeg, image/png, image/webp, image/avif\"}]]}],\"\\n\"]}]]}],[\"$\",\"hr\",null,{\"className\":\"my-10\"}],[\"$\",\"$L13\",null,{}]]\n"])</script><script>self.__next_f.push([1,"10:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Next.js Image 어떻게 최적화 할까?\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Image 최적화 과정과 Canary 버전에서 확인해보는 신기능?도 있었다.\"}],[\"$\",\"meta\",\"4\",{\"name\":\"keywords\",\"content\":\"gogleset,Next,Image\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:title\",\"content\":\"Next.js Image 어떻게 최적화 할까?\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:description\",\"content\":\"Image 최적화 과정과 Canary 버전에서 확인해보는 신기능?도 있었다.\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:site_name\",\"content\":\"https://gogleset.github.io\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:title\",\"content\":\"Next.js Image 어떻게 최적화 할까?\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:description\",\"content\":\"Image 최적화 과정과 Canary 버전에서 확인해보는 신기능?도 있었다.\"}],[\"$\",\"link\",\"12\",{\"rel\":\"icon\",\"href\":\"/favicon-32x32.png\"}],[\"$\",\"link\",\"13\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-touch-icon.png\"}]]\n3:null\n"])</script></body></html>